<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do-List - Application Complète</title>
    <style>
        /**
         * To-Do-List Application - Etape N4
         * Dashboard complet avec gestion des tâches
         * Auteur: Mikail Lekesiz
         * Formation: LP DWCA 2025
         */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 42px;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            font-size: 20px;
            font-weight: 600;
        }
        
        .card-body {
            padding: 25px;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 6px;
            font-size: 13px;
        }
        
        label .required {
            color: #e74c3c;
        }
        
        input[type="text"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23667eea' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 35px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 100%;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn-secondary:hover {
            background: #d5dbdb;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            margin: 0 3px;
        }
        
        .btn-edit {
            background: #3498db;
            color: white;
        }
        
        .btn-edit:hover {
            background: #2980b9;
        }
        
        .btn-complete {
            background: #2ecc71;
            color: white;
        }
        
        .btn-complete:hover {
            background: #27ae60;
        }
        
        .btn-delete {
            background: #e74c3c;
            color: white;
        }
        
        .btn-delete:hover {
            background: #c0392b;
        }
        
        /* Dashboard Styles */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn:hover,
        .filter-btn.active {
            background: #667eea;
            color: white;
        }
        
        .task-list {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .task-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
        }
        
        .task-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateX(5px);
        }
        
        .task-item.completed {
            opacity: 0.6;
            border-left-color: #2ecc71;
        }
        
        .task-item.completed .task-title {
            text-decoration: line-through;
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }
        
        .task-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .task-id {
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .task-description {
            color: #7f8c8d;
            font-size: 13px;
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .task-meta {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .badge-priority-1,
        .badge-priority-2 {
            background: #fee;
            color: #c0392b;
        }
        
        .badge-priority-3 {
            background: #fff3cd;
            color: #856404;
        }
        
        .badge-priority-4,
        .badge-priority-5,
        .badge-priority-6 {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .badge-status {
            background: #e8f4fd;
            color: #2c3e50;
        }
        
        .task-actions {
            display: flex;
            gap: 5px;
            justify-content: flex-end;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }
        
        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .empty-state-text {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .empty-state-subtext {
            font-size: 14px;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .modal-body {
            padding: 25px;
        }
        
        /* Responsive */
        @media (max-width: 968px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 32px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .task-actions {
                flex-direction: column;
            }
            
            .btn-small {
                width: 100%;
                margin: 3px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📝 To-Do-List</h1>
            <p>Application complète avec localStorage - Par Mikail Lekesiz</p>
        </div>
        
        <div class="main-grid">
            <!-- Formulaire d'ajout -->
            <div class="card">
                <div class="card-header">
                    ➕ Nouvelle tâche
                </div>
                <div class="card-body">
                    <form id="taskForm">
                        <div class="form-group">
                            <label for="libelle">Libellé <span class="required">*</span></label>
                            <input type="text" id="libelle" required placeholder="Titre de la tâche">
                        </div>
                        
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea id="description" placeholder="Détails..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="dateCreation">Date création</label>
                            <input type="date" id="dateCreation">
                        </div>
                        
                        <div class="form-group">
                            <label for="dateFinalisation">Date fin</label>
                            <input type="date" id="dateFinalisation">
                        </div>
                        
                        <div class="form-group">
                            <label for="priorite">Priorité <span class="required">*</span></label>
                            <select id="priorite" required></select>
                        </div>
                        
                        <div class="form-group">
                            <label for="complexite">Complexité</label>
                            <select id="complexite"></select>
                        </div>
                        
                        <div class="form-group">
                            <label for="categorie">Catégorie</label>
                            <select id="categorie"></select>
                        </div>
                        
                        <div class="form-group">
                            <label for="duree">Durée</label>
                            <select id="duree"></select>
                        </div>
                        
                        <div class="form-group">
                            <label for="statut">Statut</label>
                            <select id="statut"></select>
                        </div>
                        
                        <div class="form-group">
                            <label for="auteur">Auteur</label>
                            <input type="text" id="auteur" value="Mikail Lekesiz">
                        </div>
                        
                        <button type="submit" class="btn-primary">💾 Enregistrer</button>
                        <button type="reset" class="btn-secondary">🔄 Réinitialiser</button>
                    </form>
                </div>
            </div>
            
            <!-- Dashboard -->
            <div class="card">
                <div class="card-header">
                    📊 Dashboard
                </div>
                <div class="card-body">
                    <!-- Statistiques -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="statTotal">0</div>
                            <div class="stat-label">Total</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="statEnCours">0</div>
                            <div class="stat-label">En cours</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="statTerminees">0</div>
                            <div class="stat-label">Terminées</div>
                        </div>
                    </div>
                    
                    <!-- Filtres -->
                    <div class="filters">
                        <button class="filter-btn active" data-filter="all">Toutes</button>
                        <button class="filter-btn" data-filter="Planifiée">📋 Planifiées</button>
                        <button class="filter-btn" data-filter="En cours">🔄 En cours</button>
                        <button class="filter-btn" data-filter="Terminée">✅ Terminées</button>
                    </div>
                    
                    <!-- Liste des tâches -->
                    <div class="task-list" id="taskList">
                        <div class="empty-state">
                            <div class="empty-state-icon">📝</div>
                            <div class="empty-state-text">Aucune tâche</div>
                            <div class="empty-state-subtext">Ajoutez votre première tâche!</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal d'édition -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                ✏️ Modifier la tâche
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <input type="hidden" id="editId">
                    
                    <div class="form-group">
                        <label for="editLibelle">Libellé <span class="required">*</span></label>
                        <input type="text" id="editLibelle" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editDescription">Description</label>
                        <textarea id="editDescription"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="editDateFinalisation">Date fin</label>
                        <input type="date" id="editDateFinalisation">
                    </div>
                    
                    <div class="form-group">
                        <label for="editPriorite">Priorité</label>
                        <select id="editPriorite"></select>
                    </div>
                    
                    <div class="form-group">
                        <label for="editStatut">Statut</label>
                        <select id="editStatut"></select>
                    </div>
                    
                    <button type="submit" class="btn-primary">💾 Sauvegarder</button>
                    <button type="button" class="btn-secondary" onclick="closeEditModal()">❌ Annuler</button>
                </form>
            </div>
        </div>
    </div>
    
    <script>
        /**
         * To-Do-List Application Complète - Etape N4
         * Dashboard avec gestion complète des tâches
         * Auteur: Mikail Lekesiz
         * Formation: LP DWCA 2025
         */
        
        // Données JSON
        const DATA = {
            priorites: [
                {"idPriorite":"1","priorite":"Critique","emoji":"🔴"},
                {"idPriorite":"2","priorite":"Très important","emoji":"🟠"},
                {"idPriorite":"3","priorite":"Important","emoji":"🟡"},
                {"idPriorite":"4","priorite":"Moyen","emoji":"🟢"},
                {"idPriorite":"5","priorite":"Peu important","emoji":"🔵"},
                {"idPriorite":"6","priorite":"Non urgent","emoji":"⚪"}
            ],
            complexites: [
                {"idComplexite":"1","complexite":"Très simple"},
                {"idComplexite":"2","complexite":"Simple"},
                {"idComplexite":"3","complexite":"Moyenne"},
                {"idComplexite":"4","complexite":"Complexe"},
                {"idComplexite":"5","complexite":"Très complexe"}
            ],
            categories: [
                {"idCategorie":"1","categorie":"Développement Web"},
                {"idCategorie":"2","categorie":"DevOps & Cloud"},
                {"idCategorie":"3","categorie":"Intelligence Artificielle"},
                {"idCategorie":"4","categorie":"Formation"},
                {"idCategorie":"5","categorie":"Documentation"},
                {"idCategorie":"6","categorie":"Réunion"},
                {"idCategorie":"7","categorie":"Personnel"}
            ],
            durees: [
                {"idDuree":"1","duree":"< 30 min"},
                {"idDuree":"2","duree":"30 min - 1h"},
                {"idDuree":"3","duree":"1-2h"},
                {"idDuree":"4","duree":"2-4h"},
                {"idDuree":"5","duree":"4-8h"},
                {"idDuree":"6","duree":"> 1 jour"},
                {"idDuree":"7","duree":"Plusieurs jours"}
            ],
            statuts: [
                {"idStatut":"1","statut":"Planifiée"},
                {"idStatut":"2","statut":"En cours"},
                {"idStatut":"3","statut":"Terminée"}
            ]
        };
        
        const STORAGE_KEY = 'todolist_tasks_lpdwca';
        let currentFilter = 'all';
        
        // Fonctions localStorage
        function loadTasks() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
        }
        
        function saveTasks(tasks) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
        }
        
        // Helpers
        function getPriorite(id) {
            return DATA.priorites.find(p => p.idPriorite === id);
        }
        
        function getStatut(name) {
            return DATA.statuts.find(s => s.statut === name);
        }
        
        // Populate selects
        function populateSelect(selectId, data, idKey, labelKey, emojiKey) {
            const select = document.getElementById(selectId);
            select.innerHTML = '<option value="">-- Sélectionnez --</option>';
            data.forEach(item => {
                const option = document.createElement('option');
                option.value = item[idKey];
                option.textContent = `${item[emojiKey] || ''} ${item[labelKey]}`.trim();
                select.appendChild(option);
            });
        }
        
        function initSelects() {
            populateSelect('priorite', DATA.priorites, 'idPriorite', 'priorite', 'emoji');
            populateSelect('complexite', DATA.complexites, 'idComplexite', 'complexite');
            populateSelect('categorie', DATA.categories, 'idCategorie', 'categorie');
            populateSelect('duree', DATA.durees, 'idDuree', 'duree');
            populateSelect('statut', DATA.statuts, 'idStatut', 'statut');
            populateSelect('editPriorite', DATA.priorites, 'idPriorite', 'priorite', 'emoji');
            populateSelect('editStatut', DATA.statuts, 'idStatut', 'statut');
            
            document.getElementById('statut').value = '2'; // En cours par défaut
        }
        
        // Stats
        function updateStats() {
            const tasks = loadTasks();
            const total = tasks.length;
            const enCours = tasks.filter(t => t.statut === 'En cours').length;
            const terminees = tasks.filter(t => t.statut === 'Terminée').length;
            
            document.getElementById('statTotal').textContent = total;
            document.getElementById('statEnCours').textContent = enCours;
            document.getElementById('statTerminees').textContent = terminees;
        }
        
        // Render tasks
        function renderTasks() {
            const tasks = loadTasks();
            const taskList = document.getElementById('taskList');
            
            let filteredTasks = tasks;
            if (currentFilter !== 'all') {
                filteredTasks = tasks.filter(t => t.statut === currentFilter);
            }
            
            if (filteredTasks.length === 0) {
                taskList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">📝</div>
                        <div class="empty-state-text">Aucune tâche</div>
                        <div class="empty-state-subtext">${currentFilter === 'all' ? 'Ajoutez votre première tâche!' : 'Aucune tâche dans ce filtre'}</div>
                    </div>
                `;
                return;
            }
            
            taskList.innerHTML = filteredTasks.map(task => {
                const priorite = getPriorite(task.idPriorite);
                const isCompleted = task.statut === 'Terminée';
                
                return `
                    <div class="task-item ${isCompleted ? 'completed' : ''}">
                        <div class="task-header">
                            <div>
                                <div class="task-title">${task.libelle}</div>
                                <div class="task-description">${task.description || 'Aucune description'}</div>
                            </div>
                            <span class="task-id">#${task.idTache}</span>
                        </div>
                        <div class="task-meta">
                            <span class="badge badge-priority-${task.idPriorite}">
                                ${priorite ? priorite.emoji + ' ' + priorite.priorite : 'N/A'}
                            </span>
                            <span class="badge badge-status">${task.statut}</span>
                            ${task.dateFinalisation ? `<span class="badge">📅 ${task.dateFinalisation}</span>` : ''}
                            ${task.auteur ? `<span class="badge">👤 ${task.auteur}</span>` : ''}
                        </div>
                        <div class="task-actions">
                            <button class="btn-small btn-edit" onclick="editTask(${task.idTache})">✏️ Modifier</button>
                            ${!isCompleted ? `<button class="btn-small btn-complete" onclick="completeTask(${task.idTache})">✅ Terminer</button>` : ''}
                            <button class="btn-small btn-delete" onclick="deleteTask(${task.idTache})">🗑️ Supprimer</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            updateStats();
        }
        
        // Add task
        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const tasks = loadTasks();
            const newId = tasks.length + 1;
            
            const statutSelect = document.getElementById('statut');
            const statutText = statutSelect.options[statutSelect.selectedIndex].text;
            
            const newTask = {
                idTache: newId.toString(),
                libelle: document.getElementById('libelle').value,
                description: document.getElementById('description').value,
                dateCreation: document.getElementById('dateCreation').value || new Date().toISOString().split('T')[0],
                dateFinalisation: document.getElementById('dateFinalisation').value,
                idPriorite: document.getElementById('priorite').value,
                idComplexite: document.getElementById('complexite').value,
                idCategorie: document.getElementById('categorie').value,
                idDuree: document.getElementById('duree').value,
                statut: statutText,
                auteur: document.getElementById('auteur').value
            };
            
            tasks.push(newTask);
            saveTasks(tasks);
            
            this.reset();
            document.getElementById('dateCreation').value = new Date().toISOString().split('T')[0];
            document.getElementById('statut').value = '2';
            
            renderTasks();
            
            console.log('✅ Tâche ajoutée:', newTask);
        });
        
        // Edit task
        function editTask(id) {
            const tasks = loadTasks();
            const task = tasks.find(t => t.idTache === id.toString());
            
            if (task) {
                document.getElementById('editId').value = task.idTache;
                document.getElementById('editLibelle').value = task.libelle;
                document.getElementById('editDescription').value = task.description;
                document.getElementById('editDateFinalisation').value = task.dateFinalisation;
                document.getElementById('editPriorite').value = task.idPriorite;
                
                const statutObj = getStatut(task.statut);
                if (statutObj) {
                    document.getElementById('editStatut').value = statutObj.idStatut;
                }
                
                document.getElementById('editModal').classList.add('show');
            }
        }
        
        function closeEditModal() {
            document.getElementById('editModal').classList.remove('show');
        }
        
        document.getElementById('editForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const tasks = loadTasks();
            const id = document.getElementById('editId').value;
            const taskIndex = tasks.findIndex(t => t.idTache === id);
            
            if (taskIndex !== -1) {
                const statutSelect = document.getElementById('editStatut');
                const statutText = statutSelect.options[statutSelect.selectedIndex].text;
                
                tasks[taskIndex].libelle = document.getElementById('editLibelle').value;
                tasks[taskIndex].description = document.getElementById('editDescription').value;
                tasks[taskIndex].dateFinalisation = document.getElementById('editDateFinalisation').value;
                tasks[taskIndex].idPriorite = document.getElementById('editPriorite').value;
                tasks[taskIndex].statut = statutText;
                
                saveTasks(tasks);
                renderTasks();
                closeEditModal();
                
                console.log('✏️ Tâche modifiée:', tasks[taskIndex]);
            }
        });
        
        // Complete task
        function completeTask(id) {
            const tasks = loadTasks();
            const task = tasks.find(t => t.idTache === id.toString());
            
            if (task) {
                task.statut = 'Terminée';
                saveTasks(tasks);
                renderTasks();
                console.log('✅ Tâche terminée:', task);
            }
        }
        
        // Delete task
        function deleteTask(id) {
            if (confirm('⚠️ Supprimer cette tâche?')) {
                let tasks = loadTasks();
                tasks = tasks.filter(t => t.idTache !== id.toString());
                saveTasks(tasks);
                renderTasks();
                console.log('🗑️ Tâche supprimée: #' + id);
            }
        }
        
        // Filters
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentFilter = this.dataset.filter;
                renderTasks();
            });
        });
        
        // Init
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 To-Do-List Application - Etape N4');
            console.log('📊 Dashboard complet avec gestion des tâches');
            console.log('Auteur: Mikail Lekesiz');
            
            document.getElementById('dateCreation').value = new Date().toISOString().split('T')[0];
            
            initSelects();
            renderTasks();
            
            console.log('✅ Application initialisée!');
        });
        
        // Close modal on outside click
        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEditModal();
            }
        });
    </script>
</body>
</html>

